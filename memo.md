# タスクの種類
|種類|予測するもの|予測する種類|評価指標|
|:--|:--|:--|:--|
|回帰|物の値段、購入者数など|数値|RMSE、MAE|
|【分類】二値分類|検査結果(陽性/陰性)など|- 0or1のラベル<br> - 1である確率|- F1-score<br> - logloss、AUC|
|【分類】マルチクラス分類|検査結果(陽性/陰性)など|- 0〜nのラベルのいずれか<br> - 各ラベルである確率(合計=1)|multi-class、logloss|
|【分類】マルチラベル分類|検査結果(陽性/陰性)など|- 0〜nのラベル(複数選択もあり)<br> - 各ラベルである確率(合計≠1)|mean-F1、macro-F1|
|レコメンデーション|ユーザーが購入しそうな商品など。順位をつけて商品数を固定する方法と、順位をつけず任意の個数を予測する方法の2種類がある。||(順位あり)MAP@K<br>(順位なし)mean-F1、macro-F1|
|物体検出|画像の中の自動車と歩行者など|画像に含まれる物体のクラスと存在する矩形領域||
|セグメンテーション|画像の中の自動車と歩行者など|画像に含まれる物体のクラスと存在する領域(ピクセル単位)||

# 評価指標
## 回帰
### RMSE(Root Mean Squared Error)：平均平方二条誤差
各レコードの目的変数について予測値と真の値の差の二乗を取り、それらの平均の平方根を取る。

$RMSE = \sqrt{\frac{1}{N}\sum^{N}_{i=1}(y_{i} - \hat{y_{i}})^2}
$
- 統計学的にも大きな意味を持っている。
- 誤差の二乗を取るので、外れ値の影響を受けやすい(事前に外れ値を除外しておくなどの対処が必要)

scikit-learn.metricsモジュールの _mean_squared_error_ で計算可能。
```
import numpy as np
from sklearn.metrics import mean_squared_error

y_true = [1.0, 1.5, 2.0, 1.2, 1.8]
y_pred = [0.8, 1.5, 1.8, 1.3, 3.0]

rmse = np.sqrt(mean_squared_error(y_true, y_pred))
print(rmse)
# 0.5531726674375732
```
$RMSE = \sqrt{\frac{1}{5} \{(0.8 - 1.0)^2 + (1.5 - 1.5)^2 + (1.8 - 2.0)^2 + (1.3 - 1.2)^2 + (3.0 - 1.8)^2\}} \\\\　
= \sqrt{\frac{1}{5} (-0.2^2 + 0^2 -0.2^2 + 0.1^2 + 1.2^2)}　\\\\　
= \sqrt{\frac{1}{5} (0.04 + 0 + 0.04 + 0.01 + 1.44)}　\\\\　
= \sqrt{0.306} \\\\　= 0.5531726674375732
$



## RMSLE(Root Mean Squared Logarithmic Error)：平均平方二条対数誤差
RMSEとの違いは、予測値と真の値のそれぞれの対数を取るところ。両対数の誤差を二乗し、それらの平均の平方根を取る。

$RMSLE = \sqrt{\frac{1}{N}\sum^{N}_{i=1}(\log(1 + y_{i}) - \log(1 + \hat{y_{i}}))^2}
$

$log(1+x)=x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4 ... $という難しい計算をする。マクローリン展開というらしい。
- 目的変数が「裾の重い分布」を持ち、実の値を使用すると大きな値の影響を受けやすいときや、真の値と予測値の比率に着目したい場合に用いられる。


scikit-learn.metricsモジュールの _mean_squared_log_error_ で計算可能。

## MAE(Mean Absolute Error)
真の値と予測値の差の絶対値の平均を計算する。
$MAE=\frac{1}{N}\sum^{N}_{i=1}|y_i-\hat{y_i}| $
- 外れ値の影響を低減した形での評価に適した関数
- 仮に１つの代表値で予測を行う場合、MAEを最小化する予測値は中央値。
```
import numpy as np
from sklearn.metrics import mean_absolute_error as mae

y_true = [100, 160, 60]
y_pred = [80, 100, 100]

mae = mae(y_true, y_pred)
print(f'mae:{mae}')
# mae:40.0
```
$MAE = \frac{1}{3} (|100-80| + |160-100| + |60-100|) \\\\　
= \frac{1}{3} (20 + 60 + 40) \\\\　
= \frac{1}{3} * 120 \\\\　
= 40 \\\\　
$
